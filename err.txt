{"errors":["org.apache.flink.runtime.rest.handler.RestHandlerException: Could not execute application.
\tat org.apache.flink.runtime.webmonitor.handlers.JarRunHandler.lambda$handleRequest$1(JarRunHandler.java:114)
\tat java.base/java.util.concurrent.CompletableFuture.uniHandle(Unknown Source)
\tat java.base/java.util.concurrent.CompletableFuture$UniHandle.tryFire(Unknown Source)
\tat java.base/java.util.concurrent.CompletableFuture.postComplete(Unknown Source)
\tat java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(Unknown Source)
\tat java.base/java.lang.Thread.run(Unknown Source)
Caused by: java.util.concurrent.CompletionException: org.apache.flink.util.FlinkRuntimeException: Could not execute application.
\tat java.base/java.util.concurrent.CompletableFuture.encodeThrowable(Unknown Source)
\tat java.base/java.util.concurrent.CompletableFuture.completeThrowable(Unknown Source)
\t... 2 more
Caused by: org.apache.flink.util.FlinkRuntimeException: Could not execute application.
\tat org.apache.flink.client.deployment.application.DetachedApplicationRunner.tryExecuteJobs(DetachedApplicationRunner.java:88)
\tat org.apache.flink.client.deployment.application.DetachedApplicationRunner.run(DetachedApplicationRunner.java:70)
\tat org.apache.flink.runtime.webmonitor.handlers.JarRunHandler.lambda$handleRequest$0(JarRunHandler.java:108)
\t... 2 more
Caused by: org.apache.flink.client.program.ProgramInvocationException: The main method caused an error: Error while applying rule FlinkLogicalSinkConverter(in:NONE,out:LOGICAL), args [rel#3582:LogicalSink.NONE.any.None: 0.[NONE].[NONE](input=RelSubset#3581,table=default_catalog.default_database.sink,fields=city, num_ads)]
\tat org.apache.flink.client.program.PackagedProgram.callMainMethod(PackagedProgram.java:372)
\tat org.apache.flink.client.program.PackagedProgram.invokeInteractiveModeForExecution(PackagedProgram.java:222)
\tat org.apache.flink.client.ClientUtils.executeProgram(ClientUtils.java:105)
\tat org.apache.flink.client.deployment.application.DetachedApplicationRunner.tryExecuteJobs(DetachedApplicationRunner.java:84)
\t... 4 more
Caused by: java.lang.RuntimeException: Error while applying rule FlinkLogicalSinkConverter(in:NONE,out:LOGICAL), args [rel#3582:LogicalSink.NONE.any.None: 0.[NONE].[NONE](input=RelSubset#3581,table=default_catalog.default_database.sink,fields=city, num_ads)]
\tat org.apache.calcite.plan.volcano.VolcanoRuleCall.onMatch(VolcanoRuleCall.java:250)
\tat org.apache.calcite.plan.volcano.IterativeRuleDriver.drive(IterativeRuleDriver.java:59)
\tat org.apache.calcite.plan.volcano.VolcanoPlanner.findBestExp(VolcanoPlanner.java:523)
\tat org.apache.calcite.tools.Programs$RuleSetProgram.run(Programs.java:317)
\tat org.apache.flink.table.planner.plan.optimize.program.FlinkVolcanoProgram.optimize(FlinkVolcanoProgram.scala:62)
\tat org.apache.flink.table.planner.plan.optimize.program.FlinkChainedProgram.$anonfun$optimize$1(FlinkChainedProgram.scala:59)
\tat scala.collection.TraversableOnce.$anonfun$foldLeft$1(TraversableOnce.scala:156)
\tat scala.collection.TraversableOnce.$anonfun$foldLeft$1$adapted(TraversableOnce.scala:156)
\tat scala.collection.Iterator.foreach(Iterator.scala:937)
\tat scala.collection.Iterator.foreach$(Iterator.scala:937)
\tat scala.collection.AbstractIterator.foreach(Iterator.scala:1425)
\tat scala.collection.IterableLike.foreach(IterableLike.scala:70)
\tat scala.collection.IterableLike.foreach$(IterableLike.scala:69)
\tat scala.collection.AbstractIterable.foreach(Iterable.scala:54)
\tat scala.collection.TraversableOnce.foldLeft(TraversableOnce.scala:156)
\tat scala.collection.TraversableOnce.foldLeft$(TraversableOnce.scala:154)
\tat scala.collection.AbstractTraversable.foldLeft(Traversable.scala:104)
\tat org.apache.flink.table.planner.plan.optimize.program.FlinkChainedProgram.optimize(FlinkChainedProgram.scala:55)
\tat org.apache.flink.table.planner.plan.optimize.StreamCommonSubGraphBasedOptimizer.optimizeTree(StreamCommonSubGraphBasedOptimizer.scala:176)
\tat org.apache.flink.table.planner.plan.optimize.StreamCommonSubGraphBasedOptimizer.doOptimize(StreamCommonSubGraphBasedOptimizer.scala:83)
\tat org.apache.flink.table.planner.plan.optimize.CommonSubGraphBasedOptimizer.optimize(CommonSubGraphBasedOptimizer.scala:87)
\tat org.apache.flink.table.planner.delegation.PlannerBase.optimize(PlannerBase.scala:329)
\tat org.apache.flink.table.planner.delegation.PlannerBase.translate(PlannerBase.scala:195)
\tat org.apache.flink.table.api.internal.TableEnvironmentImpl.translate(TableEnvironmentImpl.java:1805)
\tat org.apache.flink.table.api.internal.TableEnvironmentImpl.executeInternal(TableEnvironmentImpl.java:881)
\tat org.apache.flink.table.api.internal.TableEnvironmentImpl.executeInternal(TableEnvironmentImpl.java:991)
\tat org.apache.flink.table.api.internal.TablePipelineImpl.execute(TablePipelineImpl.java:57)
\tat efrat19.AdsByCitySlidingKt.main(AdsByCitySliding.kt:82)
\tat efrat19.AdsByCitySlidingKt.main(AdsByCitySliding.kt)
\tat java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
\tat java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)
\tat java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)
\tat java.base/java.lang.reflect.Method.invoke(Unknown Source)
\tat org.apache.flink.client.program.PackagedProgram.callMainMethod(PackagedProgram.java:355)
\t... 7 more
Caused by: java.lang.RuntimeException: Error occurred while applying rule FlinkLogicalSinkConverter(in:NONE,out:LOGICAL)
\tat org.apache.calcite.plan.volcano.VolcanoRuleCall.transformTo(VolcanoRuleCall.java:157)
\tat org.apache.calcite.plan.RelOptRuleCall.transformTo(RelOptRuleCall.java:269)
\tat org.apache.calcite.plan.RelOptRuleCall.transformTo(RelOptRuleCall.java:284)
\tat org.apache.calcite.rel.convert.ConverterRule.onMatch(ConverterRule.java:174)
\tat org.apache.calcite.plan.volcano.VolcanoRuleCall.onMatch(VolcanoRuleCall.java:223)
\t... 40 more
Caused by: java.util.NoSuchElementException: No value present
\tat java.base/java.util.Optional.get(Unknown Source)
\tat org.apache.flink.table.planner.plan.utils.AggregateUtil$.toLong(AggregateUtil.scala:1176)
\tat org.apache.flink.table.planner.plan.metadata.FlinkRelMdRowCount.estimateRowCountOfWindowAgg(FlinkRelMdRowCount.scala:230)
\tat org.apache.flink.table.planner.plan.metadata.FlinkRelMdRowCount.getRowCount(FlinkRelMdRowCount.scala:202)
\tat org.apache.calcite.rel.metadata.janino.GeneratedMetadata_RowCountHandler.getRowCount_$(Unknown Source)
\tat org.apache.calcite.rel.metadata.janino.GeneratedMetadata_RowCountHandler.getRowCount(Unknown Source)
\tat org.apache.calcite.rel.metadata.RelMetadataQuery.getRowCount(RelMetadataQuery.java:258)
\tat org.apache.flink.table.planner.plan.metadata.FlinkRelMdRowCount.getRowCount(FlinkRelMdRowCount.scala:416)
\tat org.apache.calcite.rel.metadata.janino.GeneratedMetadata_RowCountHandler.getRowCount_$(Unknown Source)
\tat org.apache.calcite.rel.metadata.janino.GeneratedMetadata_RowCountHandler.getRowCount(Unknown Source)
\tat org.apache.calcite.rel.metadata.RelMetadataQuery.getRowCount(RelMetadataQuery.java:258)
\tat org.apache.flink.table.planner.plan.metadata.FlinkRelMdRowCount.getRowCount(FlinkRelMdRowCount.scala:55)
\tat org.apache.calcite.rel.metadata.janino.GeneratedMetadata_RowCountHandler.getRowCount_$(Unknown Source)
\tat org.apache.calcite.rel.metadata.janino.GeneratedMetadata_RowCountHandler.getRowCount(Unknown Source)
\tat org.apache.calcite.rel.metadata.RelMetadataQuery.getRowCount(RelMetadataQuery.java:258)
\tat org.apache.flink.table.planner.plan.metadata.FlinkRelMdRowCount.getRowCount(FlinkRelMdRowCount.scala:416)
\tat org.apache.calcite.rel.metadata.janino.GeneratedMetadata_RowCountHandler.getRowCount_$(Unknown Source)
\tat org.apache.calcite.rel.metadata.janino.GeneratedMetadata_RowCountHandler.getRowCount(Unknown Source)
\tat org.apache.calcite.rel.metadata.RelMetadataQuery.getRowCount(RelMetadataQuery.java:258)
\tat org.apache.calcite.rel.SingleRel.estimateRowCount(SingleRel.java:68)
\tat org.apache.flink.table.planner.plan.metadata.FlinkRelMdRowCount.getRowCount(FlinkRelMdRowCount.scala:443)
\tat org.apache.calcite.rel.metadata.janino.GeneratedMetadata_RowCountHandler.getRowCount_$(Unknown Source)
\tat org.apache.calcite.rel.metadata.janino.GeneratedMetadata_RowCountHandler.getRowCount(Unknown Source)
\tat org.apache.calcite.rel.metadata.RelMetadataQuery.getRowCount(RelMetadataQuery.java:258)
\tat org.apache.calcite.rel.AbstractRelNode.computeSelfCost(AbstractRelNode.java:232)
\tat org.apache.flink.table.planner.plan.metadata.FlinkRelMdNonCumulativeCost.getNonCumulativeCost(FlinkRelMdNonCumulativeCost.scala:40)
\tat org.apache.calcite.rel.metadata.janino.GeneratedMetadata_NonCumulativeCostHandler.getNonCumulativeCost_$(Unknown Source)
\tat org.apache.calcite.rel.metadata.janino.GeneratedMetadata_NonCumulativeCostHandler.getNonCumulativeCost(Unknown Source)
\tat org.apache.calcite.rel.metadata.RelMetadataQuery.getNonCumulativeCost(RelMetadataQuery.java:331)
\tat org.apache.calcite.plan.volcano.VolcanoPlanner.getCost(VolcanoPlanner.java:727)
\tat org.apache.calcite.plan.volcano.VolcanoPlanner.getCostOrInfinite(VolcanoPlanner.java:714)
\tat org.apache.calcite.plan.volcano.VolcanoPlanner.propagateCostImprovements(VolcanoPlanner.java:971)
\tat org.apache.calcite.plan.volcano.VolcanoPlanner.addRelToSet(VolcanoPlanner.java:1408)
\tat org.apache.calcite.plan.volcano.VolcanoPlanner.registerImpl(VolcanoPlanner.java:1368)
\tat org.apache.calcite.plan.volcano.VolcanoPlanner.register(VolcanoPlanner.java:598)
\tat org.apache.calcite.plan.volcano.VolcanoPlanner.ensureRegistered(VolcanoPlanner.java:613)
\tat org.apache.calcite.plan.volcano.VolcanoRuleCall.transformTo(VolcanoRuleCall.java:144)
\t... 44 more
"]}% 